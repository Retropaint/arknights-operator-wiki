<app-header></app-header>

<ion-content>
  <p *ngIf="!database.isLoaded" style="text-align: center; margin-top: 10px">Loading... {{dbGetter.jsonLoadingProgress / dbGetter.maxJsonFiles | numberFormatter: 'percent'}}</p>
  
  <ng-container *ngIf="database.isLoaded && operator">
    <p class="op-name">{{operator.name}}</p>

    <div class="tabs">
      <p (click)="currentTab = 'info'" [ngClass]="{'selected' : currentTab == 'info'}">Gameplay Info</p>
      <p (click)="currentTab = 'gallery'" [ngClass]="{'selected' : currentTab == 'gallery'}">Gallery</p>
      <p (click)="currentTab = 'profile'" [ngClass]="{'selected' : currentTab == 'profile'}">Profile</p>
      <p (click)="currentTab = 'dialogue'" [ngClass]="{'selected' : currentTab == 'dialogue'}">Dialogue</p>
    </div>

    <div class="dead-zone container" [ngClass]="{'not-selected-tab' : currentTab != 'info'}">

      <div class="left-container">

        <app-operator-briefer
          [operator]="operator"
        ></app-operator-briefer>

        <app-stat-table
          [subject]="operator"
        ></app-stat-table>

        <app-elite-unlock-reqs-table
          [operator]="operator"
        ></app-elite-unlock-reqs-table>

        <app-talent-table
          [operator]="operator"
        ></app-talent-table>

        <app-potential-table
          [operator]="operator"
        ></app-potential-table>

        <app-base-skill-table
          [operator]="operator"
        ></app-base-skill-table>

        <app-module-table
          *ngFor="let item of operator.modules; let i = index;"
          [operator]="operator"
          [moduleIndex]="i"
        ></app-module-table>

      </div>

      <div class="right-container">

        <!--
        <p class="close-gallery" (click)="isGalleryOpen = !isGalleryOpen">{{isGalleryOpen ? 'Close' : 'Open'}} mini-gallery</p>
        -->

        <app-operator-gallery
          *ngIf="isGalleryOpen"
          [operator]="operator"
        ></app-operator-gallery>

        <app-skill-table *ngIf="operator.rarity > 2 && !operator.name.includes('Reserve')"
          [operator]="operator"
        ></app-skill-table>

        <app-summon-table
          *ngFor="let summon of operator.summons"
          [summon]="summon"
        ></app-summon-table>
        <!--
          <app-stat-table
          *ngFor="let summon of operator.summons"
          [subject]="summon"
        ></app-stat-table>
        -->


        <app-skill-level-unlock-reqs-table *ngIf="operator.rarity > 2 && !operator.name.includes('Reserve')"
          [operator]="operator"
        ></app-skill-level-unlock-reqs-table>
      </div>

    </div>

    <div [ngClass]="{'not-selected-tab' : currentTab != 'gallery'}">
      <app-operator-gallery
        [isTab]="true"
        [operator]="operator"
      ></app-operator-gallery>
    </div>

    <div [ngClass]="{'not-selected-tab' : currentTab != 'profile'}" >
      <app-profile-tab [operator]="operator"></app-profile-tab>
    </div>

    <div [ngClass]="{'not-selected-tab' : currentTab != 'dialogue'}">
      <app-dialogue-table
        [operator]="operator"
      ></app-dialogue-table>
    </div>
  </ng-container>
</ion-content>
